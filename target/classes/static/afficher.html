<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liste des personnes</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            max-width: 600px; 
            margin: 0 auto;
        }
        button { 
            background-color: #28a745; 
            color: white; 
            padding: 10px 20px; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer;
            font-size: 16px;
            margin-bottom: 20px;
        }
        button:hover { background-color: #218838; }
        .person-list { 
            list-style-type: none; 
            padding: 0; 
        }
        .person-item { 
            padding: 10px; 
            margin: 5px 0; 
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
        }
        .empty-message { 
            text-align: center; 
            color: #6c757d; 
            font-style: italic;
        }
        .error-message { 
            color: red; 
            text-align: center;
        }
        .nav-link { 
            display: inline-block; 
            margin-top: 20px; 
            color: #007bff; 
            text-decoration: none;
        }
        .nav-link:hover { text-decoration: underline; }
        .loading { 
            text-align: center; 
            color: #007bff;
        }
    </style>
</head>
<body>

<h1>Liste des Personnes</h1>

<button onclick="loadPersons()">Actualiser la liste</button>

<div id="personsList"></div>

<a href="index.html" class="nav-link">← Retour à l'accueil</a>

<script>
    // Charger automatiquement la liste au chargement de la page
    document.addEventListener('DOMContentLoaded', loadPersons);

    function loadPersons() {
        const container = document.getElementById('personsList');
        container.innerHTML = '<p class="loading">Chargement...</p>';
        
        fetch('/api/personnes')
        .then(response => {
            if (!response.ok) {
                throw new Error(`Erreur HTTP: ${response.status}`);
            }
            return response.json();
        })
        .then(persons => {
            displayPersons(persons);
        })
        .catch(error => {
            console.error('Erreur:', error);
            container.innerHTML = '<p class="error-message">Impossible de récupérer les données. Veuillez réessayer.</p>';
        });
    }

    function displayPersons(persons) {
        const container = document.getElementById('personsList');
        
        if (!persons || persons.length === 0) {
            container.innerHTML = '<p class="empty-message">Aucune personne enregistrée.</p>';
            return;
        }

        const list = document.createElement('ul');
        list.className = 'person-list';

        persons.forEach(person => {
            const item = document.createElement('li');
            item.className = 'person-item';
            item.innerHTML = `<strong>${person.nom}</strong> - ${person.age} ans`;
            list.appendChild(item);
        });

        container.innerHTML = '';
        container.appendChild(list);
    }
</script>

</body>
</html>
