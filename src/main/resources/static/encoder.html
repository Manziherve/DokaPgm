<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Encoder une personne</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        input, button { margin: 5px 0; padding: 8px; font-size: 14px; width: 300px; }
        label { display: block; margin-top: 10px; }
        #message { margin-top: 15px; }
        a { display: block; margin-top: 20px; }
    </style>
</head>
<body>

<h1>Ajouter une Personne</h1>

<form id="lecteurForm">
    <label for="nom">Nom :</label>
    <input type="text" id="nom" name="nom" required>

    <label for="age">Age :</label>
    <input type="number" id="age" name="age" required>

    <br>
    <button type="submit">Ajouter</button>
</form>

<div id="message"></div>

<a href="index.html">Retour à l'accueil</a>

<script>
    document.getElementById('lecteurForm').addEventListener('submit', function (e) {
        e.preventDefault(); // empêche la page de recharger

        const personne = {
            nom: document.getElementById('nom').value,
            age: parseInt(document.getElementById('age').value)
        };

        fetch(window.location.origin + '/api/personnes', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(personne)
        })
        .then(response => {
            if (!response.ok) throw new Error("Erreur HTTP : " + response.status);
            return response.json();
        })
        .then(data => {
            document.getElementById('message').innerHTML = `<p style="color:green;">${data.nom} ajouté avec succès !</p>`;
            document.getElementById('lecteurForm').reset();
        })
        .catch(error => {
            console.error("Erreur :", error);
            document.getElementById('message').innerHTML = `<p style="color:red;">Erreur lors de l’ajout.</p>`;
        });
    });
</script>

</body>
</html>
