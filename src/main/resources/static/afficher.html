<!DOCTYPE html>
<html>
<head>
    <title>Liste des Personnes</title>
    <meta charset="UTF-8">
</head>
<body>
    <h1>Liste des Personnes</h1>
    
    <button onclick="loadPersons()">Actualiser</button>
    
    <div id="personsList"></div>
    
    <p><a href="index.html">Retour √† l'accueil</a></p>

<script>
    // Charger automatiquement au d√©marrage
    document.addEventListener('DOMContentLoaded', loadPersons);

    function loadPersons() {
        console.log('Chargement des personnes...');
        const container = document.getElementById('personsList');
        container.innerHTML = '<p>Chargement...</p>';
        
        // D√©tection automatique de l'environnement
        const isLocal = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
        const apiUrl = isLocal ? '/api/personnes' : 'https://monpgm-cy65.onrender.com/api/personnes';
        
        console.log('üåç Environnement:', isLocal ? 'LOCAL' : 'PRODUCTION');
        console.log('üîó URL API:', apiUrl);
        
        fetch(apiUrl)
        .then(response => {
            console.log('R√©ponse:', response.status);
            if (!response.ok) {
                throw new Error('Erreur HTTP: ' + response.status);
            }
            return response.json();
        })
        .then(persons => {
            console.log('Donn√©es re√ßues:', persons);
            displayPersons(persons);
        })
        .catch(error => {
            console.error('Erreur:', error);
            container.innerHTML = '<p style="color:red">Erreur: Impossible de r√©cup√©rer les donn√©es.</p>';
        });
    }

    function displayPersons(persons) {
        const container = document.getElementById('personsList');
        
        if (!persons || persons.length === 0) {
            container.innerHTML = '<p>Aucune personne enregistr√©e.</p>';
            return;
        }

        let html = '<ul>';
        persons.forEach(person => {
            html += '<li>' + person.nom + ' - ' + person.age + ' ans</li>';
        });
        html += '</ul>';
        
        container.innerHTML = html;
    }
</script>

</body>
</html>
